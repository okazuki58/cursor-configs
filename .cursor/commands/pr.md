# プルリクエスト作成

このコマンドは、コミット済みの変更内容を分析し、PRテンプレートに従って自動的にプルリクエストを作成します。

## 引数

- `issue_url` (オプション): 関連するIssueのURLを指定

## 実行内容

1. **差分分析**: `git diff develop..HEAD` を実行してコミット済みの変更内容を確認
2. **PR内容生成**: `.github/PULL_REQUEST_TEMPLATE.md` のテンプレートに従って日本語でPR内容を作成
3. **ブランチプッシュ**: 現在のブランチをリモートにプッシュ
4. **プルリクエスト作成**: GitHub上でプルリクエストを作成

## プロセス詳細

### ステップ1: コミット済み差分の確認と分析
- `git diff develop..HEAD --name-only` でコミット済みファイル一覧を取得
- `git diff develop..HEAD` でコミット済みの詳細な変更内容を確認
- 変更されたファイルの種類と内容を分析

### ステップ2: PR内容の自動生成
以下のテンプレートに従って内容を生成：

- **関連するissue**: `issue_url`引数が指定されている場合は自動でリンクを挿入
- **概要**: 変更されたファイルと内容から自動生成
- **背景**: コミットメッセージと変更内容から推測して生成
- **動作確認**: 変更内容に応じた確認方法を提案
- **その他**: 重要な変更や注意事項があれば記載

```
## 関連する issue

close #イシュー番号

## 概要

{変更内容の概要を日本語で自動生成}

## 背景

{変更の背景や問題点について詳しく説明}

## 動作確認

{このPRが正しく動作するかどうか確認した方法を記載}

## その他

{レビュー時の注意点、特記事項}
```

### ステップ3: Git操作の実行
1. 現在のブランチをリモートにプッシュ（コミットは事前に手動で完了済み）
2. GitHub CLI (`gh`) または GitHub API を使用してPRを作成

### ステップ4: PR作成
- 生成したPR内容をボディに設定
- 適切なタイトルを自動生成
- レビュアーやラベルを設定（設定されている場合）

## 使用方法

### 基本的な使用方法
1. **事前準備**: 変更内容を手動でコミット
2. Cursorのチャットで `/pr` と入力
3. コマンドを選択して実行
4. 自動的にPRが作成されるのを確認

### 関連Issueがある場合
1. **事前準備**: 変更内容を手動でコミット
2. Cursorのチャットで `/pr https://github.com/your-repo/issues/123` と入力
3. コマンドを選択して実行
4. 関連IssueのリンクがPR内容に自動挿入される

### 使用例
```
/pr
/pr https://github.com/ogawakazuki/sig/issues/456
/pr https://github.com/your-org/your-repo/issues/789
```

## 前提条件

- **コミットが完了していること**（手動でコミット済み）
- GitHub CLI (`gh`) がインストールされ、認証済みであること
- 現在のブランチが `develop` 以外であること
- リモートリポジトリが設定されていること

## 注意事項

- **実行前に必ずコミットを完了させてください**
- 実行前に `git diff develop..HEAD` で変更内容を確認してください
- 機密情報や重要な変更が含まれる場合は、手動でレビューしてください
- PR作成後は適切なレビュアーにレビューを依頼してください
