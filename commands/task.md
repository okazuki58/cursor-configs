# タスク作成

今日のGitコミットをすべて取得し、内容を理解・要約・整理して開発タスク化せよ。
チャットの直前のやり取りを分析し、実行者が明日達成しようとしているゴールを推測せよ。
そのゴールに沿った形で、翌日の作業タスクを構築し、Slack日報形式の報告出力を作成し、最終的にGitHub CLIを使用してIssueとして登録せよ。

---

1. **会話の文脈を解析する**

   * Cursor上の直前のチャットのやり取りをすべて参照し、実行者の意図・課題・目標を推定する。
   * 明日の作業ゴールを明確化し、その達成に必要なタスクを逆算して計画を立てる。
   * ゴールが曖昧な場合は、当日のコミット内容と整合する範囲で最も自然な到達点を推論する。

2. **今日のコミット差分を取得する**
   以下のGitコマンドを使用して、当日0時以降のすべてのコミットを取得する：

   ```bash
   git log --since=midnight --pretty=format:"%h | %an | %s | %cd" --date=short
   ```

   必要に応じて詳細差分を解析する：

   ```bash
   git log --since=midnight -p
   ```

   すべてのコミットを解析し、変更箇所・目的・影響範囲・意図を理解する。

3. **コミット内容を要約してタスク化する**
   各コミットの目的を自然言語で要約し、行動可能なタスク単位に変換する。
   同様の作業は統合し、冗長性を排除せよ。

4. **翌日の作業タスクを生成する**
   今日の成果および推定されたゴールを踏まえて、翌日に行うべき具体的なタスクを推論する。
   継続作業・改善点・未完了項目を抽出し、優先度順に整理する。
   これらのタスクが翌日のゴール達成に直接つながるように設計する。

5. **タスクをGitHub Issueとして作成する**

   * 以下のテンプレートをもとに、生成した内容をGitHub Issueとして登録する。
   * `gh issue create` コマンドを使用して、タイトル・本文を自動で設定し作成せよ。
   * チャットに結果を出力せず、Issue作成後に生成されたURLのみを返す。

   **Issue本文テンプレート:**

   ```markdown
   ## タスク名
   {タスクのタイトル（短く具体的に）}

   ## 概要
   {コミット内容およびチャット文脈から要約された変更・目的・進捗}

   ## 詳細タスク
   - [ ] {作業1}
   - [ ] {作業2}
   - [ ] {作業3}

   ## 優先度
   {High / Medium / Low}

   ## ステータス
   {未着手 / 進行中 / 完了}

   ## 備考
   {関連情報や参照リンクなど}
   ```

   **実行例:**

   ```bash
   gh issue create --title "{タスク名}" --body-file ./generated_task.md
   ```

6. **Slack日報形式で出力を作成する**

   * この日報は**翌日にSlackへ投稿する想定**で生成すること。
   * したがって、`*昨日やったこと*` は**このコマンドを実行した日の作業（例：10月6日）**、`*今日やること*` は**翌日の計画（例：10月7日）**を指す。
     以下のフォーマットで生成し、必要に応じてIssue本文の末尾に追記する：

   ```markdown
   *昨日やったこと*
   - {今日のコミットから抽出された作業1}
   - {作業2}
   - {作業3}

   *今日やること*
   - {明日のタスク1}
   - {明日のタスク2}
   - {明日のタスク3}
   ```

7. **出力ポリシー**

   * チャットに説明文を出力してはならない。
   * 出力はIssue作成を通じてのみ行う。
   * チャットには最終的なIssueのURLのみ返す。
   * 処理全体は全自動で実行・整形・登録する。
