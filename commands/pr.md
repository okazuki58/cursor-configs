# プルリクエスト作成

このコマンドは、コミット済みの変更内容を分析し、**簡潔でわかりやすい**PR内容を自動生成します。手動テストの再現方法も詳細に記載します。

## 引数

- `issue_url` (オプション): 関連するIssueのURLを指定

## 実行内容

1. **差分分析**: `git diff develop..HEAD` を実行してコミット済みの変更内容を確認
2. **PR内容生成**: 簡潔でわかりやすいPR内容を自動生成
   - 概要と背景は2〜3文で簡潔に
   - 手動テストの再現方法を番号付きで詳細に記載
   - 専門用語は最小限に
3. **ブランチプッシュ**: 現在のブランチをリモートにプッシュ
4. **プルリクエスト作成**: GitHub上でプルリクエストを作成

## プロセス詳細

### ステップ1: コミット済み差分の確認と分析
- `git diff develop..HEAD --name-only` でコミット済みファイル一覧を取得
- `git diff develop..HEAD` でコミット済みの詳細な変更内容を確認
- 変更されたファイルの種類と内容を分析

### ステップ2: PR内容の自動生成
以下のテンプレートに従って**簡潔でわかりやすく**内容を生成：

- **関連するissue**: `issue_url`引数が指定されている場合は自動でリンクを挿入
- **概要**: 変更内容を1〜2文で簡潔に説明
- **背景**: 問題の原因と修正理由を簡潔に説明（専門用語は最小限に）
- **動作確認**: 
  - 自動テストの実行結果
  - **手動テストの再現方法を詳細に記載**（番号付きの手順で、どの画面で何を押すかを明確に）
  - 期待する結果
- **その他**: 変更ファイルのリストと簡潔な補足のみ

```
## 関連する issue

close #イシュー番号

## 概要

{1〜2文で簡潔に}

## 背景

{問題の原因と修正理由を2〜3文で}

## 動作確認

### 自動テスト
{テスト実行コマンドと結果}

### 手動テスト
#### ①操作手順のタイトル
1. 〇〇画面で××を押下する
2. △△を入力する
3. ...

#### ②次の操作手順のタイトル
1. ...

#### 期待する結果
- 〇〇が表示されること
- △△が正しく動作すること

## その他

**変更ファイル:**
- ファイル名 (変更内容)
```

### ステップ3: Git操作の実行
1. 現在のブランチをリモートにプッシュ（コミットは事前に手動で完了済み）
2. GitHub CLI (`gh`) または GitHub API を使用してPRを作成

### ステップ4: PR作成
- 生成したPR内容をボディに設定
- 適切なタイトルを自動生成
- レビュアーやラベルを設定（設定されている場合）

## 使用方法

### 基本的な使用方法
1. **事前準備**: 変更内容を手動でコミット
2. Cursorのチャットで `/pr` と入力
3. コマンドを選択して実行
4. 自動的にPRが作成されるのを確認

### 関連Issueがある場合
1. **事前準備**: 変更内容を手動でコミット
2. Cursorのチャットで `/pr https://github.com/your-repo/issues/123` と入力
3. コマンドを選択して実行
4. 関連IssueのリンクがPR内容に自動挿入される

### 使用例
```
/pr
/pr https://github.com/ogawakazuki/sig/issues/456
/pr https://github.com/your-org/your-repo/issues/789
```

## 前提条件

- **コミットが完了していること**（手動でコミット済み）
- GitHub CLI (`gh`) がインストールされ、認証済みであること
- 現在のブランチが `develop` 以外であること
- リモートリポジトリが設定されていること

## 注意事項

- **実行前に必ずコミットを完了させてください**
- PR内容は**簡潔でわかりやすく**書くこと（冗長な説明は避ける）
- 手動テストの再現方法は**番号付きで詳細に**記載すること
- 専門用語は最小限に抑え、誰が読んでも理解できるように書くこと
- PR作成後は適切なレビュアーにレビューを依頼してください
